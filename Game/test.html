<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FM OS 12</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
       .desktop {
            background: url('back.jpg') no-repeat;
            background-size: cover;
            position: relative;
            width: 100%;
            height: 100%;
			cursor: default;
        }
.taskbar {
    background-color: #2e2e2e; /* Etwas helleres Dunkelgrau */
    color: #d1d1d1; /* Helles Grau für besseren Kontrast */
    height: 40px; /* Zurück zur ursprünglichen Höhe */
    position: fixed; /* Fixiert am unteren Rand des Bildschirms */
    bottom: 0;
    width: 100%;
    display: flex;
    align-items: center;
    padding: 0 15px; /* Angepasstes Padding für ein kompakteres Layout */
    box-shadow: 0 -1px 4px rgba(0, 0, 0, 0.2); /* Sanfter Schatten für Tiefe */
    z-index: 1000; /* Taskbar immer oben */
    border-top: 1px solid #444; /* Dünne obere Border für Struktur */
}

.selected {
    border: 2px solid #cc0000; /* Dunkleres Rot für die Auswahl */
    background-color: rgba(204, 0, 0, 0.2); /* Dunkleres Rot für den Hintergrund */
    border-radius: 3px; /* Etwas kleinere abgerundete Ecken */
}

.taskbar button {
    background: none;
    border: none;
    color: #d1d1d1; /* Gleiche Farbe wie die Textfarbe der Taskbar */
    cursor: pointer;
    margin-right: 12px; /* Etwas weniger Abstand zwischen Buttons */
    font-size: 14px; /* Kleinere Schriftgröße für kompakteres Design */
    transition: color 0.3s, background-color 0.3s; /* Sanfte Übergänge für Hover-Effekte */
}

.taskbar button:hover {
    color: #ff4d4d; /* Helleres Rot beim Hover */
    background-color: rgba(255, 77, 77, 0.1); /* Leichtes Hintergrund-Rot beim Hover */
    border-radius: 3px; /* Gleiche abgerundete Ecken beim Hover */
}
       .window {
            background-color: rgba(30, 30, 30, 0.7);
            border: 1px solid #000;
            position: absolute;
            top: 50px;
            left: 50px;
            width: 300px;
            height: 200px;
            display: none;
            flex-direction: column;
            z-index: 10;
        }
		.windowi {
            background-color: rgba(30, 30, 30, 0.7);
            border: 1px solid #000;
            position: absolute;
            top: 50px;
            left: 50px;
            width: 1200px;
            height: 600px;
            display: none;
            flex-direction: column;
            z-index: 10;
        }
		.windowstore {
            background-color: rgba(30, 30, 30, 0.7);
            border: 1px solid #000;
            position: absolute;
            top: 50px;
            left: 50px;
            width: 1200px;
			transform: scale(0.5);
			opacity: 0;
            height: 600px;
            display: none;
            flex-direction: column;
            z-index: 10;
        }
		.windowifram {
            background-color: rgba(30, 30, 30, 0.7);
            border: 1px solid #000;
            position: absolute;
            top: 50px;
            left: 50px;
            width: 1200px;
            height: 600px;
            display: none;
			transform: scale(0.5);
			opacity: 0;
            flex-direction: column;
            z-index: 10;
        }.windowifra {
            background-color: rgba(30, 30, 30, 0.7);
            border: 1px solid #000;
            position: absolute;
            top: 50px;
            left: 50px;
            width: 1200px;
            height: 600px;
            display: none;
			transform: scale(0.5);
			opacity: 0;
            flex-direction: column;
            z-index: 10;
        }.windowifr {
            background-color: rgba(30, 30, 30, 0.7);
            border: 1px solid #000;
            position: absolute;
            top: 50px;
            left: 50px;
            width: 1200px;
            height: 600px;
            display: none;
			transform: scale(0.5);
			opacity: 0;
            flex-direction: column;
            z-index: 10;
        }.windowif {
            background-color: rgba(30, 30, 30, 0.7);
            border: 1px solid #000;
            position: absolute;
            top: 50px;
            left: 50px;
            width: 1200px;
            height: 600px;
            display: none;
            flex-direction: column;
            z-index: 10;
			transform: scale(0.5);
			opacity: 0;
		}.windowifc {
            background-color: rgba(30, 30, 30, 0.7);
            border: 1px solid #000;
            position: absolute;
            top: 50px;
            left: 50px;
            width: 1200px;
            height: 600px;
			transform: scale(0.5);
			opacity: 0;
            display: none;
            flex-direction: column;
            z-index: 10;
		}.windowiframefiles {
            background-color: rgba(30, 30, 30, 0.7);
            border: 1px solid #000;
            position: absolute;
            top: 50px;
            left: 50px;
            width: 1200px;
			transform: scale(0.5);
			opacity: 0;
            height: 600px;
            display: none;
            flex-direction: column;
            z-index: 10;
        }
.terminal-window {
  background-color: #333;
  padding: 10px;
  border: 1px solid #444;
  border-radius: 10px;
  width: 800px;
  height: 600px;
  overflow: auto;
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  transition: opacity 0.5s, transform 0.5s; /* add transition effect */
}

.resize-handle {
  position: absolute;
  bottom: 0;
  right: 0;
  width: 10px;
  height: 10px;
  background-color: #ccc;
  cursor: se-resize;
}

.terminal-header {
  background-color: #444;
  padding: 10px;
  border-bottom: 1px solid #555;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.terminal-title {
  color: #fff;
  font-weight: bold;
}

.terminal-buttons {
  display: flex;
  align-items: center;
}

.terminal-button {
  background-color: #555;
  color: #fff;
  border: none;
  padding: 10px 20px;
  font-size: 16px;
  cursor: pointer;
}

.terminal-button:hover {
  background-color: #666;
}

.terminal-body {
  padding: 20px;
}

.terminal-output {
  padding: 10px;
  font-family: monospace;
  color: #fff;
}

.terminal-prompt {
  color: #6c5ce7; /* purple color */
}

.terminal-result {
  color: #0f0; /* green color */
}

.terminal-error {
  color: #f00; /* red color */
}

#terminal-input {
  background-color: #333;
  color: #fff;
  padding: 10px;
  font-family: monospace;
  border: none;
  resize: none;
  width: 100%;
}

#selection-window {
  position: absolute;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(30, 30, 30, 0.8); /* Transparenter Hintergrund für einen Glas-Effekt */
  border: 1px solid rgba(255, 255, 255, 0.2); /* Subtiler, transparenter Rand */
  border-radius: 12px; /* Mehr abgerundete Ecken */
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4), 0 0 16px rgba(0, 0, 0, 0.2); /* Etwas kleinerer Schatten */
  display: none;
  padding: 15px; /* Leicht reduziertes Padding */
  box-sizing: border-box;
  width: 220px; /* Kleinere Breite */
  backdrop-filter: blur(8px); /* Leicht reduzierter Blur-Effekt */
  transition: opacity 0.3s ease, transform 0.3s ease;
}

#folsel-window {
  position: absolute;
  bottom: 20px;
  left: 60%;
  transform: translateX(-50%);
  background: rgba(30, 30, 30, 0.8); /* Transparenter Hintergrund für einen Glas-Effekt */
  border: 1px solid rgba(255, 255, 255, 0.2); /* Subtiler, transparenter Rand */
  border-radius: 12px; /* Mehr abgerundete Ecken */
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4), 0 0 16px rgba(0, 0, 0, 0.2); /* Etwas kleinerer Schatten */
  display: none;
  padding: 15px; /* Leicht reduziertes Padding */
  box-sizing: border-box;
  width: 220px; /* Kleinere Breite */
  backdrop-filter: blur(8px); /* Leicht reduzierter Blur-Effekt */
  transition: opacity 0.3s ease, transform 0.3s ease;
}

#folsel-window.active {
  display: block;
  opacity: 1;
}

#selection-window.active {
  display: block;
  opacity: 1;
}

#selection-window button {
  background: linear-gradient(145deg, #333, #444); /* Verlaufseffekt für Knöpfe */
  border: none;
  color: #f0f0f0; /* Helles Grau für den Text */
  padding: 8px 14px; /* Leicht reduziertes Padding */
  margin-bottom: 8px; /* Etwas weniger Margin */
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px; /* Etwas kleinere Schriftgröße */
  transition: background 0.3s, transform 0.2s, box-shadow 0.2s;
  width: 100%;
}

#folsel-window button {
  background: linear-gradient(145deg, #333, #444); /* Verlaufseffekt für Knöpfe */
  border: none;
  color: #f0f0f0; /* Helles Grau für den Text */
  padding: 8px 14px; /* Leicht reduziertes Padding */
  margin-bottom: 8px; /* Etwas weniger Margin */
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px; /* Etwas kleinere Schriftgröße */
  transition: background 0.3s, transform 0.2s, box-shadow 0.2s;
  width: 100%;
}

#selection-window button:hover {
  background: linear-gradient(145deg, #444, #555); /* Verlauf für Hover-Effekt */
  transform: scale(1.05);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); /* Sanfter Schatten beim Hover */
}

#folsel-window button:hover {
  background: linear-gradient(145deg, #444, #555); /* Verlauf für Hover-Effekt */
  transform: scale(1.05);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); /* Sanfter Schatten beim Hover */
}

#selection-window button:focus {
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 170, 255, 0.6); /* Blauer Schatten für den Fokus */
  background: linear-gradient(145deg, #333, #444); /* Konsistenz des Hintergrunds im Fokuszustand */
}

#folsel-window button:focus {
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 170, 255, 0.6); /* Blauer Schatten für den Fokus */
  background: linear-gradient(145deg, #333, #444); /* Konsistenz des Hintergrunds im Fokuszustand */
}

@media (prefers-reduced-motion: no-preference) {
  #selection-window {
    animation: fadeInUp 0.5s ease-out;
  }
}

@media (prefers-reduced-motion: no-preference) {
  #folsel-window {
    animation: fadeInUp 0.5s ease-out;
  }
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.windowiframefiles.animate-in {
  animation: animate-in 0.5s forwards;
}

.windowifc.animate-in {
  animation: animate-in 0.5s forwards;
}

.windowstore.animate-in {
  animation: animate-in 0.5s forwards;
}

.windowifr.animate-in {
  animation: animate-in 0.5s forwards;
}

.windowifram.animate-in {
  animation: animate-in 0.5s forwards;
}

.windowifra.animate-in {
  animation: animate-in 0.5s forwards;
}

@keyframes animate-in {
  0% {
    transform: scale(0.5);
    opacity: 0;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

#selection-window button:hover {
  background-color: #eee;
}

#folsel-window button:hover {
  background-color: #eee;
}
       .window-header {
            background-color: rgba(20, 20, 20, 0.7);
            color: #00ff00;
			text-shadow: 0 0 5px #00ff00, 0 0 10px #00ff00, 0 0 15px #00ff00,
						0 0 20px #00ff00, 0 0 25px #00ff00, 0 0 30px #00ff00;
            padding: 5px;
            cursor: move;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
       .window-body {
            flex: 1;
            padding: 10px;
        }
       .window-footer {
            padding: 5px;
            text-align: right;
        }
       .icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 100px;
            height: 100px;
            background-color: white;
            border: 1px solid #000;
            margin: 10px;
            font-size: 20px;
            cursor: pointer;
            user-select: none;
            transition: transform 0.2s ease-out;
            background-size: 100px 100px; /* Größe des Logo-Images anpassen */
            background-position: center; /* Logo-Image zentrieren */
        }
       .icon[data-file$=".js"] {
            background-image: url('js.jpg');
        }
       .icon[data-file$=".fexe"] {
            background-image: url('fexe.jpg');
        }
       .icon[data-file$=".fsys"] {
            background-image: url('fsys.jpg');
		}
		.icon[data-file$=".py"] {
            background-image: url('py.jpg');
		}
       .icon[data-file$=".zfp"] {
            background-image: url('folder.jpg');
		}
       .icon[data-file$=".html"] {
            background-image: url('html.jpg');
        }
		.icon[data-file$=".url"] {
            background-image: url('url.jpg');
        }
		.icon[data-file$=".png"] {
            background-image: url('png.jpg');
		}
		.icon[data-file$=".folder"] {
            background-image: url('fol.png');
		}
		.icon[data-file$=".fak"] {
            background-image: url('fak.jpg');
        }
       .icon:not([data-file$=".js"]):not([data-file$=".fexe"]):not([data-file$=".folder"]):not([data-file$=".fsys"]):not([data-file$=".fak"]):not([data-file$=".png"]):not([data-file$=".url"]):not([data-file$=".zfp"]):not([data-file$=".html"]):not([data-file$=".py"]) {
            background-image: url('ico.jpg');
        }
       .icon[data-folder] {
            background-image: url('folder.jpg');
        }
       .icon.dragging {
            position: absolute;
            z-index: 100;
        }
       .icon span {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            color: white; /* Weißer Text */
        }
.context-menu {
    position: absolute;
    background: rgba(30, 30, 30, 0.8); /* Highly transparent dark background */
    border: none; /* No border for a sleek look */
    border-radius: 10px; /* Rounded corners for a modern feel */
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4); /* Softer shadow for subtle depth */
    display: none;
    z-index: 100;
    font-family: 'Roboto', sans-serif; /* Modern, clean font */
    width: 100px; /* Narrow width */
    overflow: hidden; /* Hide overflow for a cleaner design */
    backdrop-filter: blur(10px); /* Blur effect for a glass-like appearance */
    animation: fadeIn 0.2s ease-out; /* Fade-in animation */
}

.context-menu ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.context-menu ul li {
    padding: 8px 12px; /* Adequate padding for a sleek look */
    cursor: pointer;
    color: #d0d0d0; /* Light gray text color */
    background: rgba(30, 30, 30, 0.6); /* Matching semi-transparent background */
    border-radius: 6px; /* Rounded corners for menu items */
    transition: background 0.3s ease, color 0.3s ease, text-shadow 0.3s ease; /* Smooth transitions */
}

.context-menu ul li:hover {
    background: rgba(30, 30, 30, 0.7); /* Slightly darker transparent background on hover */
    color: #fff; /* White text color on hover */
    text-shadow: 0 0 8px #00ff99, 0 0 16px #00ff99; /* Neon green glow effect */
}

.context-menu ul li:active {
    background: rgba(30, 30, 30, 0.8); /* Darker transparent background when clicked */
    color: #fff; /* White text color when active */
    text-shadow: 0 0 4px #00ff99, 0 0 8px #00ff99; /* Slightly dimmer glow effect on active */
}

.redlightcolor {
    color: #ff0000;
	text-shadow: 0 0 5px #ff0000, 0 0 10px #ff0000, 0 0 15px #ff0000,
				0 0 20px #ff0000, 0 0 25px #ff0000, 0 0 30px #ff0000;
}

.greenlightcolor {
    color: #00ff00;
	text-shadow: 0 0 5px #00ff00, 0 0 10px #00ff00, 0 0 15px #00ff00,
				0 0 20px #00ff00, 0 0 25px #00ff00, 0 0 30px #00ff00;
}

.textcoloreditor {
    color: #ffffff;
	text-shadow: 0 0 1px #0000ff, 0 0 2.5px #0000ff, 0 0 5px #0000ff,
				0 0 5px #0000ff, 0 0 8px #0000ff, 0 0 10px #0000ff;
	background-color: rgba(20, 20, 20, 0.7);
}

/* Animation for fading in */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
.file-label {
    margin-top: 120px;
    font-size: 12px;
    color: #ff0000;
    text-align: center;
    font-weight: bold;
    text-shadow: 0 0 5px #ff0000, 0 0 10px #ff0000, 0 0 15px #ff0000,
                 0 0 20px #ff0000, 0 0 25px #ff0000, 0 0 30px #ff0000;
}

#sysset-window {
  position: absolute;
  bottom: 20px;
  left: 70%;
  transform: translateX(-50%);
  background: rgba(30, 30, 30, 0.8);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4), 0 0 16px rgba(0, 0, 0, 0.2);
  display: none;
  padding: 15px;
  box-sizing: border-box;
  width: 220px;
  backdrop-filter: blur(8px);
  transition: opacity 0.3s ease, transform 0.3s ease;
}

#sysset-window.active {
  display: block;
  opacity: 1;
}

#sysset-window button {
  background: linear-gradient(145deg, #333, #444); /* Verlaufseffekt für Knöpfe */
  border: none;
  color: #f0f0f0;
  padding: 8px 14px;
  margin-bottom: 8px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
  transition: background 0.3s, transform 0.2s, box-shadow 0.2s;
  width: 100%;
}

#sysset-window button:hover {
  background: linear-gradient(145deg, #444, #555); /* Verlauf für Hover-Effekt */
  transform: scale(1.05);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); /* Sanfter Schatten beim Hover */
}

#sysset-window button:focus {
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 170, 255, 0.6);
  background: linear-gradient(145deg, #333, #444);
}

@media (prefers-reduced-motion: no-preference) {
  #sysset-window {
    animation: fadeInUp 0.5s ease-out;
  }
}

#sysset-window button:hover {
  background-color: #eee;
}
#appsfinder-window {
  position: absolute;
  bottom: 70px;
  left: 7%;
  transform: translateX(-50%);
  background: rgba(30, 30, 30, 0.8);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 12px;
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4), 0 0 16px rgba(0, 0, 0, 0.2);
  display: none;
  padding: 15px;
  box-sizing: border-box;
  width: 220px;
  backdrop-filter: blur(8px);
  transition: opacity 0.3s ease, transform 0.3s ease;
}

#appsfinder-window.active {
  display: block;
  opacity: 1;
}

#appsfinder-window button {
  display: flex;
  align-items: center;
  background: linear-gradient(145deg, #333, #444); /* Gradient for buttons */
  border: none;
  color: #f0f0f0;
  padding: 8px 14px;
  margin-bottom: 8px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
  transition: background 0.3s, transform 0.2s, box-shadow 0.2s;
  width: 100%;
}

.button-icon {
  width: 20px;
  height: 20px;
  margin-right: 8px;
  border-radius: 4px;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

#appsfinder-window button:hover .button-icon {
  transform: translateY(-2px);
  transform: scale(1.05);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}

#appsfinder-window button:hover {
  background: linear-gradient(145deg, #444, #555); /* Gradient for hover effect */
  transform: scale(1.05);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}

#appsfinder-window button:focus {
  outline: none;
  box-shadow: 0 0 0 2px rgba(0, 170, 255, 0.6);
  background: linear-gradient(145deg, #333, #444);
}

@media (prefers-reduced-motion: no-preference) {
  #appsfinder-window {
    animation: fadeInUp 0.5s ease-out;
  }
}

#appsfinder-window button:hover {
  background-color: #eee;
}
/* Styling für die Fehlermeldung */
/* Styling für die Fehlermeldung */
.error-message {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: #2c2c2c; /* Dunkleres, mattes Grau für modernen Look */
    color: #ff0000;
	text-shadow: 0 0 5px #ff0000, 0 0 10px #ff0000, 0 0 15px #ff0000,
				0 0 20px #ff0000, 0 0 25px #ff0000, 0 0 30px #ff0000;
    padding: 30px 50px;
    border-radius: 12px; /* Leicht abgerundete Ecken */
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4); /* Weicher Schatten für Tiefe */
    font-family: 'Roboto', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    text-align: center;
    z-index: 1000;
    animation: fadeIn 0.4s ease-in-out;
    max-width: 90%;
    width: 360px;
}

/* Styling für den Text innerhalb der Fehlermeldung */
.error-message span {
    display: block;
    margin-bottom: 20px; /* Abstand zwischen Text und Button */
    font-size: 18px; /* Größerer, gut lesbarer Text */
}

.error-message .ok-button {
    padding: 12px 30px;
    background: rgba(20, 20, 20, 0.7);
    border: none;
    color: #fff;
    border-radius: 6px; /* Leicht abgerundet für einen modernen Button */
    font-size: 16px;
    cursor: pointer;
    transition: background 0.3s, transform 0.2s ease-in-out;
}

.error-message .ok-button:hover {
    background: rgba(10, 10, 10, 0.7);
    transform: translateY(-2px); /* Leichter Hover-Effekt */
}

/* Einfache Fade-In Animation */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translate(-50%, -60%);
    }
    to {
        opacity: 1;
        transform: translate(-50%, -50%);
    }
}

    </style>
</head>
<body>
    <div class="desktop" id="desktop" oncontextmenu="showContextMenu(event); return false;">
    </div>
    <div class="taskbar">
        <button onclick="createFile()">New File</button>
        <button onclick="secfil()">Files</button>
		<button onclick="malwareScan()">FA AntiVira</button>
		<button class="taskbar-button" onclick="executeJSInTerminal()">Terminal</button>
		<button class="taskbar-button" onclick="restartOS()">Restart</button>
		<button class="taskbar-button" onclick="openURLInIframe()">Browser</button>
		<button class="taskbar-button" onclick="vm()">VM</button>
		<button class="taskbar-button" onclick="code()">CodeSpace</button>
	    <button class="taskbar-button" onclick="store()">Store</button>
		<button class="taskbar-button" onclick="downloadAllFiles()">Download</button>
		<button class="taskbar-button" onclick="loads()">Load_Files</button>
		<button class="taskbar-button" onclick="uploadFile()">Upload</button>
		<button class="taskbar-button" onclick="openDiscordLink()">Discord</button>
		<button id="toggle-selection" onclick="appwindowfinder()">Apps</button>
		<button id="toggle-selection" onclick="toggleSelectionWindow()">Style_Settings</button>
		<button id="toggle-selection" onclick="syssettings()">Settings</button>
		<div id="selection-window" class="hidden">
			<button id="option1" onclick="thememodern()">Theme:Modern</button>
			<button id="option1" onclick="updateTextColorEditor()">Texteditor:White</button>
			<button id="option1" onclick="updateTextColorEditordef()">Texteditor:Default</button>
			<button id="option2" onclick="changeDesktopBackgrounddarkfmos()">Dark FMOS</button>
			<button id="option1" onclick="changeDesktopBackground()">Space</button>
			<button id="option2" onclick="changeDesktopBackground2()">Hacker</button>
			<button id="option3" onclick="changeDesktopBackground3()">Flower</button>
			<button id="option3" onclick="changeDesktopBackground30()">Color</button>
			<button id="option4" onclick="changeDesktopBackground40()">FMOS</button>
			<button id="option4" onclick="changeDesktopBackground6()">Abstract</button>
			<button id="option5" onclick="changeDesktopBackground5()">Custom</button>
			<button id="option6" onclick="changeTerminalBackground()">Terminal:Custom</button>
			<button id="option7" onclick="changeTerminalBackground2()">Terminal:Space</button>
			<button id="option7" onclick="setTaskbarTransparent()">Taskbar:Transparent</button>
			<button id="option7" onclick="getAndSetTaskbarBackgroundColor()">Taskbar:Color</button>
			<button id="option7" onclick="resetTaskbarBackgroundColor()">Taskbar:Default</button>
			<button id="option7" onclick="setCompactFuturisticTaskbarStyle()">Taskbar:Modern</button>
			<button id="option7" onclick="crdits()">Credits</button>
			<button id="option7" onclick="toggleSelectionWindow()">Close</button>
		</div>
		<div id="folsel-window" class="hidden">
			<button id="option1" onclick="savedesktopWithCustomName()">Save Desktop Name (this will overwrite the old desktop content)</button>
			<button id="option1" onclick="loaddesktopContent()">Load Desktop Content</button>
			<button id="option1" onclick="showAllFMOSdesktopNames()">Show all Desktop Names</button>
			<button id="option2" onclick="deleteSpecificdesktop()">Delete Folder</button>
			<button id="option3" onclick="deleteAllFMOSdesktopItems()">Delete All Desktops</button>
			<button id="option1" onclick="saveFolderWithNameOnly()">Save Folder (this will overwrite the old desktop content)</button>
			<button id="option1" onclick="saveFolderWithPath()">Save Folder in Path(this will overwrite the old desktop content)</button>
			<button id="option1" onclick="loadFolderWithNameOnly()">Load Folder Content</button>
			<button id="option1" onclick="deleteFolderWithPath()">Load Folder Content in Path</button>
			<button id="option1" onclick="showAllFolders()">Show all Folder Names</button>
			<button id="option1" onclick="showCurrentFolder()">Show all Current Folder</button>
			<button id="option2" onclick="deleteFolderWithNameOnly()">Delete Folder</button>
			<button id="option2" onclick="deleteFolderWithPath()">Delete Folder with Path</button>
			<button id="option3" onclick="deleteAllFolders()">Delete All Folders</button>
			<button id="option4" onclick="folsell()">Close This Menu</button>
		</div>
		<div id="sysset-window" class="hidden">
			<button id="option7" onclick="setFullScreenIframeKeyTrue()">Enable Boot Screen</button>
			<button id="option7" onclick="setFullScreenIframeKeyFalse()">Disable Boot Screen</button>
			<button id="option7" onclick="passwordmgr()">Password</button>
			<button id="option7" onclick="sysfactoriereset()">Reset</button>
			<button id="option7" onclick="enableFileNames()">Enable File Names</button>
			<button id="option7" onclick="disableFileNames()">Disable File Names</button>
			<button id="option7" onclick="folsell()">Folder Options</button>
			<button id="option7" onclick="syssettings()">Close</button>
		</div>
		<div id="appsfinder-window" class="hidden">
			<button id="option1" onclick="syssettings()">
			    <img onclick="syssettings()" src="settingsapp.png" alt="icon" class="button-icon"> Settings
			</button>
			<button id="option1" onclick="toggleSelectionWindow()">
			    <img onclick="toggleSelectionWindow()" src="styleapp.png" alt="icon" class="button-icon"> OS Style
			</button>
			<button id="option1" onclick="folsell()">
			    <img onclick="folsell()" src="f.png" alt="icon" class="button-icon"> Folder Options
			</button>
			<button id="option1" onclick="foldermgr()">
			    <img onclick="foldermgr()" src="f.png" alt="icon" class="button-icon"> Folder MGR
			</button>
			<button id="option1" onclick="executeJSInTerminal()">
			    <img onclick="executeJSInTerminal()" src="termapp.png" alt="icon" class="button-icon"> FM Shell
			</button>
			<button id="option1" onclick="musik()">
			    <img onclick="musik()" src="musikapp.png" alt="icon" class="button-icon"> Musik
			</button>
			<button id="option1" onclick="vm()">
			    <img onclick="vm()" src="vmapp.png" alt="icon" class="button-icon"> VM
			</button>
			<button id="option1" onclick="openURLInIframe()">
			    <img onclick="openURLInIframe()" src="t.jpg" alt="icon" class="button-icon"> Browser
			</button>
			<button id="option1" onclick="passwordmgr()">
			    <img onclick="passwordmgr()" src="passapp.png" alt="icon" class="button-icon"> Password MGR
			</button>
			<button id="option1" onclick="code()">
			    <img onclick="code()" src="py.jpg" alt="icon" class="button-icon"> CodeSpace
			</button>
			<button id="option1" onclick="store()">
			    <img onclick="store()" src="storeapp.png" alt="icon" class="button-icon"> Store
			</button>
			<button id="option4" onclick="appwindowfinder()" class="redlightcolor" >X</button>
		</div>
    </div>
	<div class="window" id="editorWindow">
		<div class="window-header">
			<span id="editorTitle">Editor</span>
			<button onclick="closeWindow()" style="background:none; border:none;" class="redlightcolor">X</button>
		</div>
		<div class="window-body">
			<textarea id="fileContent" style="width: 100%; height: 100%; border: 1px solid rgba(255, 255, 255, 0.2); overflow: auto;" class="textcoloreditor" ></textarea>
		</div>
		<div class="window-footer">
			<button onclick="saveFile()" style="background:none; border:none; border: 1px solid rgba(255, 255, 255, 0.2); transition: transform 0.3s ease, box-shadow 0.3s ease; box-shadow: 0 0 10px rgba(0, 255, 0, 0.5); transform: perspective(1px) translateZ(0); outline:none;" class="greenlightcolor" onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 0 20px rgba(0, 255, 0, 1)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(0, 255, 0, 0.5)';">Save</button>
			<button onclick="deleteFile()" style="background:none; border:none; border: 1px solid rgba(255, 255, 255, 0.2); transition: transform 0.3s ease, box-shadow 0.3s ease; box-shadow: 0 0 10px rgba(0, 255, 0, 0.5); transform: perspective(1px) translateZ(0); outline:none;" class="greenlightcolor" onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 0 20px rgba(0, 255, 0, 1)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(0, 255, 0, 0.5)';">Delete</button>
			<button onclick="executeJS()" style="background:none; border:none; border: 1px solid rgba(255, 255, 255, 0.2); transition: transform 0.3s ease, box-shadow 0.3s ease; box-shadow: 0 0 10px rgba(0, 255, 0, 0.5); transform: perspective(1px) translateZ(0); outline:none;" class="greenlightcolor" onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 0 20px rgba(0, 255, 0, 1)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 0 10px rgba(0, 255, 0, 0.5)';">Run</button>
		</div>
	</div>

	<!-- Add a new window for HTML preview -->
	<div class="windowi" id="htmlPreviewWindow" style="display: none;">
		<div class="window-header">
			<span id="htmlPreviewTitle">HTML Preview</span>
			<button onclick="closeHTMLPreviewWindow()" style="background:none; border:none;" class="textcoloreditor" >X</button>
		</div>
		<div class="window-body">
			<iframe id="htmlPreview" frameborder="0" width="100%" height="100%"></iframe>
		</div>
	</div>
    <div class="context-menu" id="contextMenu">
        <ul>
			<li onclick="createFile()">New</li>
			<li onclick="folsell()">Folders</li>
			<li onclick="executeJS()">Run</li>
            <li onclick="renameFile()">Rename</li>
            <li onclick="deleteFile()">Delete</li>
            <li onclick="toggleSelectionWindow()">Style Settings</li>
			<li onclick="hideContextMenu()">Close</li>
        </ul>
    </div>

    <script>
        let files = {
          "TOS.html": `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terms of Service</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
            padding: 20px;
            background-color: #f4f4f4;
        }
        h1 {
            text-align: center;
        }
        h2 {
            color: #333;
        }
        p {
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>Terms of Service</h1>

    <h2>1. Storage of Files in LocalStorage</h2>
    <p>We reserve the right to store files and data in the LocalStorage of your browser. This may include, but is not limited to, configuration data, user preferences, and other related information.</p>

    <h2>2. Responsibility and Risk</h2>
    <p>You acknowledge and agree that all data and information processed, stored, or otherwise handled through this service may be lost, corrupted, or otherwise compromised. You are 100% responsible for any and all consequences, damages, or losses that may arise from using this service, including but not limited to data loss, hardware damage, or any other issues.</p>

    <h2>3. No Warranty</h2>
    <p>The service is provided "as-is" with no warranty, express or implied. We do not guarantee that the service will be error-free, secure, or uninterrupted. You use the service entirely at your own risk, and we are not liable for any damages, losses, or issues that may occur as a result of using the service.</p>

    <h2>4. Modification of Terms</h2>
    <p>We reserve the right to modify these Terms of Service at any time. Any changes will be effective immediately upon posting. It is your responsibility to review these terms periodically to stay informed of any updates.</p>

</body>
</html>

		  `,

          "Folder MGR.fsys": `foldermgr()`,
		
		  "Caculator.fsys": `caculator()`,
		
		  "Browser.fexe": `openURLInIframe()`,

          "game.js": `let minNumber = 1;
        let maxNumber = 100;
        let targetNumber = Math.floor(Math.random() * (maxNumber - minNumber + 1)) + minNumber;
        let userGuess;

        function playGame() {
          userGuess = prompt("Guess the number between " + minNumber + " and " + maxNumber);

          if (userGuess === null) {
            return;
          }

          userGuess = parseInt(userGuess);

          if (isNaN(userGuess)) {
            alert("This is not a number.");
            playGame();
          } else if (userGuess < minNumber || userGuess > maxNumber) {
            alert("This is not a number between " + minNumber + " and " + maxNumber + ".");
            playGame();
          } else if (userGuess < targetNumber) {
            alert("Too low!");
            playGame();
          } else if (userGuess > targetNumber) {
            alert("Too high!");
            playGame();
          } else {
            alert("Right! The number was " + targetNumber + ".");
          }
        }

        playGame();`,

          "FA_AntiVira.py": `let passwordGenerator = {
          generatePassword: function(length) {
            let password = "";
            for (let i = 0; i < length; i++) {
              password += Math.random().toString(36).substr(2, 1);
           }
            return password;
          }
        };

        alert(passwordGenerator.generatePassword(12));`,

          "terminal.fexe": `executeJSInTerminal()`
        };

        let folders = {};

        let selectedFile = null;
        let currentDraggedFile = null;

        function createFile() {
            const fileName = prompt("Filename:");
            if (fileName) {
                if (!files[fileName]) {
                    files[fileName] = "";
                    renderFiles();
                } else {
                    alert("File alredy exsists.");
                }
            }
        }

        function createFolder() {
          const folderName = prompt("Foldername:");
          if (folderName) {
            if (!folders[folderName]) {
              folders[folderName] = {};
              renderFiles();
            } else {
              alert("Ordner alredy exsists.");
            }
          }
        }

function renderFiles() {
  const desktop = document.getElementById('desktop');
  desktop.innerHTML = '';
  for (const folderName in folders) {
    const folderIcon = document.createElement('div');
    folderIcon.className = 'icon';
	folderIcon.dataset.folder = folderName;
    folderIcon.innerHTML = folderName;
    folderIcon.onclick = () => openFolder(folderName);
    folderIcon.oncontextmenu = (e) => {
      selectedFile = folderName;
      showContextMenu(e);
      return false;
    };
    folderIcon.dataset.folder = folderName;
    desktop.appendChild(folderIcon);
  }
	const showFileNames = localStorage.getItem('fmosfilenamessetting') === 'true';

	for (const fileName in files) {
		const fileIcon = document.createElement('div');
		fileIcon.className = 'icon';

		// Only create and append the file label if showFileNames is true
		if (showFileNames) {
			const fileLabel = document.createElement('div');
			fileLabel.className = 'file-label';
			fileLabel.innerText = fileName;
			fileIcon.appendChild(fileLabel);
		}

		fileIcon.dataset.file = fileName;
		fileIcon.onclick = () => openFile(fileName);
		fileIcon.oncontextmenu = (e) => {
			selectedFile = fileName;
			showContextMenu(e);
			return false;
		};

		desktop.appendChild(fileIcon);
	}
	positionIcons();
}

function enableFileNames() {
    localStorage.setItem('fmosfilenamessetting', 'true');
    renderFiles();
}
function disableFileNames() {
    localStorage.setItem('fmosfilenamessetting', 'false');
    renderFiles();
}

        function openFile(fileName) {
		  new Audio('click.mp3').play();
          selectedFile = fileName;
          document.getElementById('editorTitle').innerText = `Editor - ${fileName}`;
          document.getElementById('fileContent').value = files[fileName];
          openWindow();
          if (fileName === "12345.js") {
            eval("alert(\"You found an easter egg! 🎉\");");
          }
		  if (selectedFile && selectedFile.endsWith('.folder')) {
		    openfmosfolder()
		  }
		  if (fileName === "BIOS") {
		    eval("alert(\"You found an easter egg! 🎉\");");
            window.location.href = "https://fabischau1.github.io/BIOS/";
          }
		  if (fileName === "old.fsys") {
		    eval("alert(\"You found an easter egg! 🎉\");");
            window.location.href = "https://fabischau1.github.io/FMOSold/";
          }
		  if (fileName === "oops") {
		    eval("alert(\"You found an easter egg! 🎉\");");
            window.location.href = "https://fabischau1.github.io/oops/";
          }
		  if (fileName === "BSOD") {
		    eval("alert(\"You found an easter egg! 🎉\");");
            window.location.href = "https://fabischau1.github.io/BSOD/";
          }
        }

        function openFolder(folderName) {
          const folderContent = folders[folderName];
          const folderWindow = document.createElement('div');
          folderWindow.className = 'window';
          folderWindow.innerHTML = `
            <div class="window-header">
              <span>${folderName}</span>
              <button onclick="closeFolder()">X</button>
            </div>
            <div class="window-body">
              <ul>
                ${Object.keys(folderContent).map((fileName) => `<li>${fileName}</li>`).join('')}
              </ul>
            </div>
          `;
          document.body.appendChild(folderWindow);
          folderWindow.style.top = '50px';
          folderWindow.style.left = '50px';
        }

        function closeFolder() {
          const folderWindow = document.querySelector('.window');
          folderWindow.remove();
        }

        function saveFile() {
			new Audio('click.mp3').play();
            if (selectedFile) {
                files[selectedFile] = document.getElementById('fileContent').value;
                alert('File saved.');
            }
        }

function deleteFile() {
  new Audio('click.mp3').play();
  if (selectedFile) {
    if (selectedFile.endsWith('.fsys')) {
      if (confirm('Are you sure you want to delete this system file?')) {
        if (confirm('This will delete the entire file: ' + selectedFile)) {
          delete files[selectedFile];
          closeWindow();
          renderFiles();
          selectedFile = null;
        }
      }
    } else {
      if (confirm('Are you sure you want to delete this file?')) {
        if (confirm('This will delete the entire file: ' + selectedFile)) {
          delete files[selectedFile];
          closeWindow();
          renderFiles();
          selectedFile = null;
        }
      }
    }
  }
}

function showError(message) {
	new Audio('error.mp3').play();
    // Prüfen, ob eine Fehlermeldung bereits angezeigt wird
    let existingError = document.querySelector('.error-message');
    if (existingError) {
        existingError.remove();
    }

    // Neues Fehlerdiv erstellen
    let errorDiv = document.createElement('div');
    errorDiv.classList.add('error-message');

    // Fehlermeldungstext
    let messageText = document.createElement('span');
    messageText.textContent = message;
    errorDiv.appendChild(messageText);

    // OK-Button
    let okButton = document.createElement('button');
    okButton.classList.add('ok-button');
    okButton.textContent = 'OK';
    okButton.onclick = () => errorDiv.remove();
    errorDiv.appendChild(okButton);

    // Fehlermeldung ins Dokument einfügen
    document.body.appendChild(errorDiv);
}


        function renameFile() {
            if (selectedFile) {
                const newFileName = prompt("New Filename:", selectedFile);
                if (newFileName &&!files[newFileName]) {
                    files[newFileName] = files[selectedFile];
                    delete files[selectedFile];
                    selectedFile = newFileName;
                    renderFiles();
                } else {
                    showError('An error has occurred.');
                }
            }
        }

        function openWindow() {
            document.getElementById('editorWindow').style.display = 'flex';
            document.getElementById('fileContent').focus();
            window.scrollTo(0, 0);
        }

        function closeWindow() {
            document.getElementById('editorWindow').style.display = 'none';
            document.getElementById('fileContent').blur();
        }

        function showContextMenu(event) {
            const contextMenu = document.getElementById('contextMenu');
            contextMenu.style.top = `${event.clientY}px`;
            contextMenu.style.left = `${event.clientX}px`;
            contextMenu.style.display = 'block';
            document.addEventListener('click', hideContextMenu);
        }

        function hideContextMenu() {
            document.getElementById('contextMenu').style.display = 'none';
            document.removeEventListener('click', hideContextMenu);
        }

        // Add a function to close the HTML preview window
        function closeHTMLPreviewWindow() {
            document.getElementById('htmlPreviewWindow').style.display = 'none';
        }

		function executeHTML() {
			if (selectedFile && selectedFile.endsWith('.html') || selectedFile.endsWith('.png') || selectedFile.endsWith('.fak') || selectedFile.endsWith('.url')) {
				const htmlContent = files[selectedFile];
				const iframe = document.getElementById('htmlPreview');
				iframe.srcdoc = htmlContent;
				iframe.width = '100%';
				iframe.height = '550px'; // set height to 600px
				document.getElementById('htmlPreviewWindow').style.display = 'block';
			} else {
				alert('ERROR This Filetype can not run HTML.');
			}
		}

		// Update the executeJS function to call executeHTML for HTML files
		function executeJS() {
			alert("Be Carefull with running commands or code")
		    if (selectedFile && (selectedFile.endsWith('.fexe') || selectedFile.endsWith('.js') || selectedFile.endsWith('.py') || selectedFile.endsWith('.zfp') || selectedFile.endsWith('.fsys'))) {
		        try {
		            eval(files[selectedFile]);
		        } catch (error) {
		            alert(`ERROR: ${error.message}`);
		        }
		    } else if (selectedFile && selectedFile.endsWith('.html') || selectedFile.endsWith('.png') || selectedFile.endsWith('.fak') || selectedFile.endsWith('.url')) {
		        executeHTML();
		    } else {
		        showError("ERROR This Filetype can not run Javaskript.");
		    }
		}
		
let terminalWindows = [];

function executeJSInTerminal() {
  alert("Be Carefull with running commands or code")
  const terminalWindow = document.createElement('div');
  terminalWindow.className = 'terminal-window';
  terminalWindow.innerHTML = `
    <div class="terminal-header">
      <div class="terminal-title">FM Shell</div>
      <div class="terminal-buttons">
        <button class="terminal-button" id="close-button">×</button>
      </div>
    </div>
    <div class="terminal-body">
      <div class="terminal-output" id="terminal-output">
        <span class="terminal-prompt">~$</span>
        <textarea id="terminal-input" placeholder="Enter JavaScript code..." style="width: 100%; padding: 10px; font-family: monospace; border: none; resize: none;"></textarea>
      </div>
    </div>
  `;
  document.body.appendChild(terminalWindow);

  terminalWindow.style.display = 'block';
  terminalWindow.style.opacity = 0;
  terminalWindow.style.transform = 'cale(0.5)';

  setTimeout(() => {
    terminalWindow.style.transition = 'opacity 0.5s, transform 0.5s';
    terminalWindow.style.opacity = 1;
    terminalWindow.style.transform = 'cale(1)';
  }, 10);

  const closeButton = terminalWindow.querySelector('#close-button');
  const terminalInput = terminalWindow.querySelector('#terminal-input');
  const terminalOutput = terminalWindow.querySelector('#terminal-output');

  closeButton.addEventListener('click', () => {
    terminalWindow.style.transition = 'opacity 0.5s, transform 0.5s';
    terminalWindow.style.opacity = 0;
    terminalWindow.style.transform = 'cale(0.5)';
    setTimeout(() => {
      terminalWindow.style.display = 'none';
    }, 500);
  });

  terminalInput.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
      const code = terminalInput.value;
      try {
        const result = eval(code);
        terminalOutput.innerHTML += `<span class="terminal-prompt">~$</span> ${code}<br>`;
        terminalOutput.innerHTML += `<span class="terminal-result">${result}</span><br>`;
      } catch (error) {
        terminalOutput.innerHTML += `<span class="terminal-prompt">~$</span> ${code}<br>`;
        terminalOutput.innerHTML += `<span class="terminal-error">${error.message}</span><br>`;
      }
      terminalInput.value = '';
    }
  });

  terminalWindows.push(terminalWindow);
}

function musik() {
  const iframeWindow = document.createElement('div');
  iframeWindow.className = 'windowifr'; // same class as the HTML preview iframe
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>Music</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreenmusik()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closem()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/Musik/"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block'; // show the window

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;

      // Update iframe width and height
      const iframe = iframeWindow.querySelector('#iframe');
      iframe.style.width = `${newWidth}px`;
      iframe.style.height = `${newHeight - 20}px`; // 20px is the height of the window-header
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }
}

function closem() {
  document.querySelector('.windowifr').remove();
}

function toggleFullscreenmusik() {
  const iframeWindow = document.querySelector('.windowifr');
  const iframe = document.querySelector('#iframe');
  
  // Toggle between fullscreen and normal mode
  if (iframeWindow.classList.contains('fullscreen')) {
    iframeWindow.classList.remove('fullscreen');
    iframeWindow.style.top = '50px';
    iframeWindow.style.left = '50px';
    iframeWindow.style.width = '600px'; // Default width
    iframeWindow.style.height = '600px'; // Default height
    iframe.style.width = '100%';
    iframe.style.height = '550px'; // Adjust height
  } else {
    iframeWindow.classList.add('fullscreen');
    iframeWindow.style.top = '0';
    iframeWindow.style.left = '0';
    iframeWindow.style.width = '100vw';
    iframeWindow.style.height = '100vh';
    iframe.style.width = '100%';
    iframe.style.height = 'calc(100vh - 20px)'; // 20px for the header
  }
}

function store() {
  const iframeWindow = document.createElement('div');
  iframeWindow.className = 'windowstore'; // same class as the HTML preview iframe
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>FMOS Store</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreenstore()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closeeeeeeeeeeee()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/FMOS/store.html"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block'; // show the window

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;

      // Update iframe width and height
      const iframe = iframeWindow.querySelector('#iframe');
      iframe.style.width = `${newWidth}px`;
      iframe.style.height = `${newHeight - 20}px`; // 20px is the height of the window-header
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }
}

function closeeeeeeeeeeee() {
  document.querySelector('.windowstore').remove();
}

function toggleFullscreenstore() {
  const iframeWindow = document.querySelector('.windowstore');
  const iframe = document.querySelector('#iframe');
  
  // Toggle between fullscreen and normal mode
  if (iframeWindow.classList.contains('fullscreen')) {
    iframeWindow.classList.remove('fullscreen');
    iframeWindow.style.top = '50px';
    iframeWindow.style.left = '50px';
    iframeWindow.style.width = '600px'; // Default width
    iframeWindow.style.height = '600px'; // Default height
    iframe.style.width = '100%';
    iframe.style.height = '550px'; // Adjust height
  } else {
    iframeWindow.classList.add('fullscreen');
    iframeWindow.style.top = '0';
    iframeWindow.style.left = '0';
    iframeWindow.style.width = '100vw';
    iframeWindow.style.height = '100vh';
    iframe.style.width = '100%';
    iframe.style.height = 'calc(100vh - 20px)'; // 20px for the header
  }
}

function caculator() {
  const iframeWindow = document.createElement('div');
  iframeWindow.className = 'windowifc'; // same class as the HTML preview iframe
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>Caculator</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreencaculator()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closecaculator()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/caculator/"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block'; // show the window

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }
}

function closecaculator() {
  document.querySelector('.windowifc').remove();
}

function toggleFullscreencaculator() {
  const iframeWindow = document.querySelector('.windowifc');
  const iframe = document.querySelector('#iframe');
  
  // Toggle between fullscreen and normal mode
  if (iframeWindow.classList.contains('fullscreen')) {
    iframeWindow.classList.remove('fullscreen');
    iframeWindow.style.top = '50px';
    iframeWindow.style.left = '50px';
    iframeWindow.style.width = '600px'; // Default width
    iframeWindow.style.height = '600px'; // Default height
    iframe.style.width = '100%';
    iframe.style.height = '550px'; // Adjust height
  } else {
    iframeWindow.classList.add('fullscreen');
    iframeWindow.style.top = '0';
    iframeWindow.style.left = '0';
    iframeWindow.style.width = '100vw';
    iframeWindow.style.height = '100vh';
    iframe.style.width = '100%';
    iframe.style.height = 'calc(100vh - 20px)'; // 20px for the header
  }
}

function passwordmgr() {
  const iframeWindow = document.createElement('div');
  iframeWindow.className = 'windowifc'; // same class as the HTML preview iframe
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>Password MGR</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreencaculator()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closecaculator()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/FMOSfiles/pass"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block'; // show the window

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }
}

function closecaculator() {
  document.querySelector('.windowifc').remove();
}

function crdits() {
  const iframeWindow = document.createElement('div');
  iframeWindow.className = 'windowifc'; // same class as the HTML preview iframe
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>Credits</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreencaculator()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closecaculator()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/FMOSfiles/Credits"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block'; // show the window

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }
}

function closecaculator() {
  document.querySelector('.windowifc').remove();
}

function code() {
  const iframeWindow = document.createElement('div');
  iframeWindow.className = 'windowifra'; // same class as the HTML preview iframe
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>FMcode</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreen()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closecode()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/FMcode/"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block'; // show the window

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;

      // Update iframe width and height
      const iframe = iframeWindow.querySelector('#iframe');
      iframe.style.width = `${newWidth}px`;
      iframe.style.height = `${newHeight - 20}px`; // 20px is the height of the window-header
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }
}

function closecode() {
  document.querySelector('.windowifra').remove();
}

function toggleFullscreen() {
  const iframeWindow = document.querySelector('.windowifra');
  const iframe = document.querySelector('#iframe');
  
  // Toggle between fullscreen and normal mode
  if (iframeWindow.classList.contains('fullscreen')) {
    iframeWindow.classList.remove('fullscreen');
    iframeWindow.style.top = '50px';
    iframeWindow.style.left = '50px';
    iframeWindow.style.width = '600px'; // Default width
    iframeWindow.style.height = '600px'; // Default height
    iframe.style.width = '100%';
    iframe.style.height = '550px'; // Adjust height
  } else {
    iframeWindow.classList.add('fullscreen');
    iframeWindow.style.top = '0';
    iframeWindow.style.left = '0';
    iframeWindow.style.width = '100vw';
    iframeWindow.style.height = '100vh';
    iframe.style.width = '100%';
    iframe.style.height = 'calc(100vh - 20px)'; // 20px for the header
  }
}

function secfil() {
  alert("Here you can permanently save files");
  alert("Be Carefull with running commands or code");
  alert("Tip: You Can Set A Password By Clicking On Settings Then Password");
  const iframeWindow = document.createElement('div');
  iframeWindow.className = 'windowiframefiles'; // same class as the HTML preview iframe
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>Files</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreenfiles()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closef()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/FMOSfiles/"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block'; // show the window

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;

      // Update iframe width and height
      const iframe = iframeWindow.querySelector('#iframe');
      iframe.style.width = `${newWidth}px`;
      iframe.style.height = `${newHeight - 20}px`; // 20px is the height of the window-header
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }
}

function closef() {
  document.querySelector('.windowiframefiles').remove();
}

function toggleFullscreenfiles() {
  const iframeWindow = document.querySelector('.windowiframefiles');
  const iframe = document.querySelector('#iframe');
  
  if (iframeWindow.classList.contains('fullscreen')) {
    iframeWindow.classList.remove('fullscreen');
    iframeWindow.style.top = '50px';
    iframeWindow.style.left = '50px';
    iframeWindow.style.width = '600px';
    iframeWindow.style.height = '600px';
    iframe.style.width = '100%';
    iframe.style.height = '550px';
  } else {
    iframeWindow.classList.add('fullscreen');
    iframeWindow.style.top = '0';
    iframeWindow.style.left = '0';
    iframeWindow.style.width = '100vw';
    iframeWindow.style.height = '100vh';
    iframe.style.width = '100%';
    iframe.style.height = 'calc(100vh - 20px)';
  }
}

function openURLInIframe() {
  const iframeWindow = document.createElement('div');
  iframeWindow.className = 'windowifram'; // same class as the HTML preview iframe
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>FM Browser</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreenbrowser()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closeIframeeeee()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/FMSearch/"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block'; // show the window

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;

      // Update iframe width and height
      const iframe = iframeWindow.querySelector('#iframe');
      iframe.style.width = `${newWidth}px`;
      iframe.style.height = `${newHeight - 20}px`; // 20px is the height of the window-header
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }
}

function closeIframeeeee() {
  document.querySelector('.windowifram').remove();
}

function toggleFullscreenbrowser() {
  const iframeWindow = document.querySelector('.windowifram');
  const iframe = document.querySelector('#iframe');
  
  if (iframeWindow.classList.contains('fullscreen')) {
    iframeWindow.classList.remove('fullscreen');
    iframeWindow.style.top = '50px';
    iframeWindow.style.left = '50px';
    iframeWindow.style.width = '600px';
    iframeWindow.style.height = '600px';
    iframe.style.width = '100%';
    iframe.style.height = '550px';
  } else {
    iframeWindow.classList.add('fullscreen');
    iframeWindow.style.top = '0';
    iframeWindow.style.left = '0';
    iframeWindow.style.width = '100vw';
    iframeWindow.style.height = '100vh';
    iframe.style.width = '100%';
    iframe.style.height = 'calc(100vh - 20px)';
  }
}

function updateTextColorEditor() {
    // Alle Elemente mit der Klasse 'textcoloreditor' auswählen
    var elements = document.querySelectorAll('.textcoloreditor');
    
    // Über die Elemente iterieren und die Stile ändern
    elements.forEach(function(element) {
        element.style.color = 'black';
        element.style.backgroundColor = 'white';
        // Entfernt den vorhandenen Textschatten
        element.style.textShadow = 'none';
    });
}

function updateTextColorEditordef() {
    // Alle Elemente mit der Klasse 'textcoloreditor' auswählen
    var elements = document.querySelectorAll('.textcoloreditor');
    
    // Über die Elemente iterieren und die ursprünglichen Stile wiederherstellen
    elements.forEach(function(element) {
        element.style.color = '#00000f';
        element.style.backgroundColor = 'rgba(20, 20, 20, 0.7)';
        element.style.textShadow = '0 0 1px #0000ff, 0 0 2.5px #0000ff, 0 0 5px #0000ff, 0 0 5px #0000ff, 0 0 8px #0000ff, 0 0 10px #0000ff';
    });
}


function vm() {
  const iframeWindow = document.createElement('div');
  iframeWindow.className = 'windowifra'; // same class as the HTML preview iframe
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>VM</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreenvm()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closevm()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/BIOS/"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block'; // show the window

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;

      // Update iframe width and height
      const iframe = iframeWindow.querySelector('#iframe');
      iframe.style.width = `${newWidth}px`;
      iframe.style.height = `${newHeight - 20}px`; // 20px is the height of the window-header
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }
}

function closevm() {
  document.querySelector('.windowifra').remove();
}
function toggleFullscreenvm() {
  const iframeWindow = document.querySelector('.windowifra');
  const iframe = document.querySelector('#iframe');
  
  if (iframeWindow.classList.contains('fullscreen')) {
    iframeWindow.classList.remove('fullscreen');
    iframeWindow.style.top = '50px';
    iframeWindow.style.left = '50px';
    iframeWindow.style.width = '600px';
    iframeWindow.style.height = '600px';
    iframe.style.width = '100%';
    iframe.style.height = '550px';
  } else {
    iframeWindow.classList.add('fullscreen');
    iframeWindow.style.top = '0';
    iframeWindow.style.left = '0';
    iframeWindow.style.width = '100vw';
    iframeWindow.style.height = '100vh';
    iframe.style.width = '100%';
    iframe.style.height = 'calc(100vh - 20px)';
  }
}

function uploadFile() {
  const input = document.createElement('input');
  input.type = 'file';
  input.onchange = (e) => {
    const file = e.target.files[0];
    const reader = new FileReader();
    reader.onload = (e) => {
      const fileContent = e.target.result;
      const fileName = file.name;
      files[fileName] = fileContent;
      renderFiles();
    };
    reader.readAsText(file);
  };
  input.click();
}

function changeDesktopBackground() {
  const bodyElement = document.querySelector('body');
  const desktopElement = bodyElement.querySelector('.desktop');
  desktopElement.style.backgroundImage = "url('back.jpg')";
}

function changeDesktopBackground2() {
  const bodyElement = document.querySelector('body');
  const desktopElement = bodyElement.querySelector('.desktop');
  desktopElement.style.backgroundImage = "url('123.jpg')";
}

function changeDesktopBackground3() {
  const bodyElement = document.querySelector('body');
  const desktopElement = bodyElement.querySelector('.desktop');
  desktopElement.style.backgroundImage = "url('flower.jpg')";
}

function changeDesktopBackground4() {
  const bodyElement = document.querySelector('body');
  const desktopElement = bodyElement.querySelector('.desktop');
  desktopElement.style.backgroundImage = "url('lightning.jpg')";
}

function changeDesktopBackground6() {
  const bodyElement = document.querySelector('body');
  const desktopElement = bodyElement.querySelector('.desktop');
  desktopElement.style.backgroundImage = "url('abstract.webp')";
}

function changeDesktopBackground30() {
  const bodyElement = document.querySelector('body');
  const desktopElement = bodyElement.querySelector('.desktop');
  desktopElement.style.backgroundImage = "url('col.jpg')";
}

function changeDesktopBackground40() {
  const bodyElement = document.querySelector('body');
  const desktopElement = bodyElement.querySelector('.desktop');
  desktopElement.style.backgroundImage = "url('fmoss.png')";
}

function changeDesktopBackgrounddarkfmos() {
  const bodyElement = document.querySelector('body');
  const desktopElement = bodyElement.querySelector('.desktop');
  desktopElement.style.backgroundImage = "url('Dark.jpeg')";
}

function changeDesktopBackground5() {
  const userInput = prompt("Enter a custom image URL:");
  if (userInput) {
    const bodyElement = document.querySelector('body');
    const desktopElement = bodyElement.querySelector('.desktop');
    desktopElement.style.backgroundImage = `url('${userInput}')`;
  }
}

function changeTerminalBackground() {
  // Prompt the user for the URL of a background image
  const imageUrl = prompt("Enter the URL of a background image:");

  // Check if the user entered a valid URL
  if (imageUrl) {
    // Update the CSS style for .terminal-window
    const styleElement = document.createElement("style");
    styleElement.innerHTML = `.terminal-window { background-image: url(${imageUrl}); }`;
    document.head.appendChild(styleElement);
  } else {
    alert("Invalid URL. Please enter the URL of a valid image file.");
  }
}

function thememodern() {
	changeDesktopBackground6();
	setCompactFuturisticTaskbarStyle();
}

function changeTerminalBackground() {
  // Prompt the user for the URL of a background image
  const imageUrl = prompt("Enter the URL of a background image:");

  // Check if the user entered a valid URL
  if (imageUrl) {
    // Update the CSS style for .terminal-window
    const styleElement = document.createElement("style");
    styleElement.innerHTML = `.terminal-window { background-image: url(${imageUrl}); }`;
    document.head.appendChild(styleElement);
  } else {
    alert("Invalid URL. Please enter the URL of a valid image file.");
  }
}

function changeTerminalBackground2() {
  // Update the CSS style for.terminal-window
  const styleElement = document.createElement("style");
  styleElement.innerHTML = `.terminal-window { background-image: url('back.jpg'); }`;
  document.head.appendChild(styleElement);
}

function changeTerminalBackground3() {
  // Update the CSS style for.terminal-window
  const styleElement = document.createElement("style");
  styleElement.innerHTML = `.terminal-window { background-image: url('abstract.webp'); }`;
  document.head.appendChild(styleElement);
}

function sysfactoriereset() {
	alert("WARNING")
	alert("THIS WILL DELETE ALL PERMANENTLY SAVED FILES")
	alert("WARNING")
	alert("THIS WILL DELETE THE PASSWORD")
	const userConfirmed = confirm("Do You Realy Want To Delete The Password And Files From FMOS?");
    
    // Überprüfen, welche Taste der Benutzer gedrückt hat
    if (userConfirmed) {
        localStorage.removeItem('password');
		localStorage.removeItem('files');
		deleteAllFMOSdesktopItems()
    } else {
        // Aktion ausführen, wenn der Benutzer auf "Abbrechen" klickt (optional)
        console.log("Aktion abgebrochen.");
		showError('Action Canceled.');
    }
}

function setTaskbarTransparent() {
  const taskbar = document.querySelector('.taskbar');
  taskbar.style.backgroundColor = 'transparent';
}

function setCompactFuturisticTaskbarStyle() {
    const taskbar = document.querySelector('.taskbar');
    
    if (taskbar) {
        taskbar.style.background = 'linear-gradient(135deg, rgba(46, 46, 46, 0.9), rgba(30, 30, 30, 0.9))';
        taskbar.style.color = '#e0e0e0';
        taskbar.style.height = '40px';
        taskbar.style.position = 'fixed';
        taskbar.style.bottom = '15px';
        taskbar.style.width = 'calc(100% - 30px)';
        taskbar.style.borderRadius = '20px';
        taskbar.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.3)';
        taskbar.style.padding = '0 15px';
        taskbar.style.display = 'flex';
        taskbar.style.alignItems = 'center';
        taskbar.style.justifyContent = 'space-between';
        taskbar.style.borderTop = 'none';
        taskbar.style.transition = 'all 0.3s ease-in-out';
    } else {
        console.error('Taskbar-Element wurde nicht gefunden.');
    }
}

function getAndSetTaskbarBackgroundColor() {
  const taskbar = document.querySelector('.taskbar');
  const color = prompt("Enter a color (e.g. #FF0000, red, rgba(255, 0, 0, 0.5)): ");
  if (color) {
    taskbar.style.backgroundColor = color;
  } else {
    alert("No color entered. Current color: " + taskbar.style.backgroundColor);
  }
}

function foldermgr() {
  const iframeWindow = document.createElement('div');
  iframeWindow.className = 'windowifc'; // same class as the HTML preview iframe
  iframeWindow.innerHTML = `
    <div class="window-header" style="display: flex; justify-content: space-between; align-items: center;">
      <span>Folder MGR</span>
      <div style="display: flex; gap: 5px;">
        <button onclick="toggleFullscreencaculator()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">🗖</button>
        <button onclick="closecaculator()" style="background:none; border:none; color: #ff5c5c; font-size: 16px;" class="redlightcolor">X</button>
      </div>
    </div>
    <div class="window-body">
      <iframe id="iframe" frameborder="0" width="100%" height="550px" src="https://fabischau1.github.io/FMOS/Folder/main"></iframe>
      <div class="resize-handle"></div>
    </div>
  `;
  document.body.appendChild(iframeWindow);
  iframeWindow.style.top = '50px';
  iframeWindow.style.left = '50px';
  iframeWindow.style.display = 'block'; // show the window

  // Add animation when opening the window
  iframeWindow.classList.add('animate-in');

  // Add drag functionality
  let isDragging = false;
  let offsetX, offsetY;

  iframeWindow.querySelector('.window-header').addEventListener('mousedown', (e) => {
    isDragging = true;
    offsetX = e.clientX - iframeWindow.offsetLeft;
    offsetY = e.clientY - iframeWindow.offsetTop;

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  });

  function handleMouseMove(e) {
    if (isDragging) {
      const newX = e.clientX - offsetX;
      const newY = e.clientY - offsetY;

      iframeWindow.style.top = `${newY}px`;
      iframeWindow.style.left = `${newX}px`;
    }
  }

  function handleMouseUp() {
    isDragging = false;
    document.removeEventListener('mousemove', handleMouseMove);
    document.removeEventListener('mouseup', handleMouseUp);
  }

  // Add resize functionality
  let isResizing = false;
  let startX, startY, startWidth, startHeight;

  iframeWindow.querySelector('.resize-handle').addEventListener('mousedown', (e) => {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = iframeWindow.offsetWidth;
    startHeight = iframeWindow.offsetHeight;

    document.addEventListener('mousemove', handleResizeMove);
    document.addEventListener('mouseup', handleResizeUp);
  });

  function handleResizeMove(e) {
    if (isResizing) {
      const newWidth = startWidth + (e.clientX - startX);
      const newHeight = startHeight + (e.clientY - startY);

      iframeWindow.style.width = `${newWidth}px`;
      iframeWindow.style.height = `${newHeight}px`;
    }
  }

  function handleResizeUp() {
    isResizing = false;
    document.removeEventListener('mousemove', handleResizeMove);
    document.removeEventListener('mouseup', handleResizeUp);
  }
}

function closecaculator() {
  document.querySelector('.windowifc').remove();
}

function resetTaskbarBackgroundColor() {
  const taskbar = document.querySelector('.taskbar');
  taskbar.style.backgroundColor = '#333';
}

function toggleSelectionWindow() {
  const selectionWindow = document.getElementById('selection-window');
  selectionWindow.classList.toggle('active');
}

function appwindowfinder() {
  const selectionWindow = document.getElementById('appsfinder-window');
  selectionWindow.classList.toggle('active');
}

function folsell() {
  const selectionWindow = document.getElementById('folsel-window');
  selectionWindow.classList.toggle('active');
}

function syssettings() {
  const selectionWindow = document.getElementById('sysset-window');
  selectionWindow.classList.toggle('active');
}

function openFullscreen() {
  const elem = document.documentElement;
  if (elem.requestFullscreen) {
    elem.requestFullscreen();
  } else if (elem.mozRequestFullScreen) { // Firefox
    elem.mozRequestFullScreen();
  } else if (elem.webkitRequestFullscreen) { // Chrome, Safari and Opera
    elem.webkitRequestFullscreen();
  } else if (elem.msRequestFullscreen) { // IE/Edge
    elem.msRequestFullscreen();
  }
}

window.onload = function() {
  openFullscreen();
};

function loads() {
	alert("Tip: You Can Set A Password By Clicking On Settings Then Password");
    const enteredPassword = prompt("Password:");

    const storedPassword = localStorage.getItem('password');

    if (enteredPassword === storedPassword) {
        if (localStorage.getItem('files')) {
			files = JSON.parse(localStorage.getItem('files'));
		}
		renderFiles();
    } else {
		alert("Password incorrect")
        setTimeout(askForPassword, 3000);
    }
}

function downloadAllFiles() {
  for (const file in files) {
    const fileContent = files[file];
    const fileType = getFileType(file);
    const blob = new Blob([fileContent], { type: fileType.mime });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = file;
    a.click();
    URL.revokeObjectURL(url);
  }
}

function getFileType(fileName) {
  const fileExtensions = {
    '.js': { mime: 'application/javascript' },
    '.fexe': { mime: 'application/octet-stream' },
    '.fsys': { mime: 'application/octet-stream' },
	'.fak': { mime: 'application/html' },
    '.py': { mime: 'text/x-python' },
    '.zfp': { mime: 'application/zip' },
    '.html': { mime: 'text/html' },
    '.url': { mime: 'text/html' },
  };
  const fileExtension = Object.keys(fileExtensions).find((ext) => fileName.endsWith(ext));
  return fileExtensions[fileExtension];
}

function openDiscordLink() {
        const url = 'https://discord.gg/XnPCx68ZN3';
        window.open(url, '_blank');
    }
		
		function restartOS() {
			window.location.href = "https://fabischau1.github.io/FM_OS";
		}
		
		function err003() {
			window.location.href = "https://fabischau1.github.io/FMOS/error003";
		}
		
		function DVD() {
			window.location.href = "https://fabischau1.github.io/FMOS/dvd";
		}
		
		function energiesavemode() {
			window.location.href = "https://fabischau1.github.io/FMOS/engr";
		}
		
		function BSOD() {
			window.location.href = "https://fabischau1.github.io/BSOD";
		}
		
		function kill() {
			window.location.href = "https://fabischau1.github.io/BSOD";
		}
		
		function err001() {
			window.location.href = "https://fabischau1.github.io/FMOS/Err001";
		}
		
		function err002() {
			window.location.href = "https://fabischau1.github.io/FMOS/Err002";
		}
		
		function oops() {
			window.location.href = "https://fabischau1.github.io/oops";
		}
		
		function malwareScan() {
          let safeFiles = [];
          let malwareFiles = [];
          for (let file in files) {
            if (file !== "FA_AntiVira.py") {
              let fileContent = files[file];
              if (fileContent.includes("document.documentElement.innerHTML = newHtml;") ||
                  fileContent.includes("let fileName = Math.random().toString(36).substr(2, 8);")) {
                malwareFiles.push(file);
                console.log(`Malware detected in file: ${file}`);
				alert(`Malware detected in file: ${file}`);
              } else {
                safeFiles.push(file);
                console.log(`File is safe: ${file}`);
				alert(`File is safe: ${file}`);
              }
            }
          }
          console.log(`Scan complete!`);
          console.log(`Safe files: ${safeFiles.join(", ")}`);
          console.log(`Malware files: ${malwareFiles.join(", ")}`);
		  alert(`Scan complete!`);
          alert(`Safe files: ${safeFiles.join(", ")}`);
          alert(`Malware files: ${malwareFiles.join(", ")}`);

          alert(`Stay safe with FA AntiVira`);
        }

        // Drag functionality for the window
        let isDragging = false;
        let offsetX, offsetY;

        document.querySelector('.window-header').addEventListener('mousedown', (e) => {
            isDragging = true;
            offsetX = e.clientX - document.getElementById('editorWindow').offsetLeft;
            offsetY = e.clientY - document.getElementById('editorWindow').offsetTop;

            document.addEventListener('mousemove', handleMouseMove);
            document.addEventListener('mouseup', handleMouseUp);
        });

        function handleMouseMove(e) {
            if (isDragging) {
                const newX = e.clientX - offsetX;
                const newY = e.clientY - offsetY;

                const maxX = window.innerWidth - document.getElementById('editorWindow').offsetWidth;
                const maxY = window.innerHeight - document.getElementById('editorWindow').offsetHeight;

                if (newX < 0) {
                    document.getElementById('editorWindow').style.left = '0';
                } else if (newX > maxX) {
                    document.getElementById('editorWindow').style.left = `${maxX}px`;
                } else {
                    document.getElementById('editorWindow').style.left = `${newX}px`;
                }

                if (newY < 0) {
                    document.getElementById('editorWindow').style.top = '0';
                } else if (newY > maxY) {
                    document.getElementById('editorWindow').style.top = `${maxY}px`;
                } else {
                    document.getElementById('editorWindow').style.top = `${newY}px`;
                }
            }
        }

        function handleMouseUp() {
            isDragging = false;
            document.removeEventListener('mousemove', handleMouseMove);
            document.removeEventListener('mouseup', handleMouseUp);
        }

        // Drag functionality for the icons
        let currentDraggedElement = null;

        document.querySelector('.desktop').addEventListener('mousedown', (e) => {
            if (e.target.classList.contains('icon')) {
                currentDraggedElement = e.target;
                currentDraggedFile = e.target.dataset.file;
                e.target.classList.add('dragging');
            }
        });

        document.querySelector('.desktop').addEventListener('mousemove', (e) => {
            if (currentDraggedElement) {
                const newX = e.clientX - currentDraggedElement.offsetWidth / 2;
                const newY = e.clientY - currentDraggedElement.offsetHeight / 2;

                const maxX = window.innerWidth - currentDraggedElement.offsetWidth;
                const maxY = window.innerHeight - currentDraggedElement.offsetHeight;

                if (newX < 0) {
                    currentDraggedElement.style.left = '0';
                } else if (newX > maxX) {
                    currentDraggedElement.style.left = `${maxX}px`;
                } else {
                    currentDraggedElement.style.left = `${newX}px`;
                }

                if (newY < 0) {
                    currentDraggedElement.style.top = '0';
                } else if (newY > maxY) {
                    currentDraggedElement.style.top = `${maxY}px`;
                } else {
                    currentDraggedElement.style.top = `${newY}px`;
                }
            }
        });

        document.querySelector('.desktop').addEventListener('mouseup', () => {
            if (currentDraggedElement) {
                currentDraggedElement.classList.remove('dragging');
                currentDraggedElement = null;
                currentDraggedFile = null;
            }
        });

        function positionIcons() {
            const icons = document.querySelectorAll('.icon');
            const desktopWidth = document.getElementById('desktop').offsetWidth;
            const iconWidth = icons[0].offsetWidth;
            const iconHeight = icons[0].offsetHeight;
            let x = 10;
            let y = 10;

            icons.forEach((icon) => {
                icon.style.left = `${x}px`;
                icon.style.top = `${y}px`;
                x += iconWidth + 10;
                if (x > desktopWidth - iconWidth - 10) {
                    x = 10;
                    y += iconHeight + 10;
                }
            });
        }
		
const desktop = document.getElementById('desktop');
let selection = null;
let startX = 0;
let startY = 0;

// Define color and border properties
const borderWidth = '2px'; // Border width

desktop.addEventListener('mousedown', (event) => {
  if (event.button !== 0) return; // only handle left mouse button
  startX = event.clientX;
  startY = event.clientY;
  selection = document.createElement('div');
  selection.className = 'selected';
  selection.style.position = 'absolute'; // Ensure positioning is absolute
  selection.style.left = `${startX}px`;
  selection.style.top = `${startY}px`;
  selection.style.width = '0px';
  selection.style.height = '0px';
  selection.style.borderWidth = borderWidth;
  desktop.appendChild(selection);
});

document.addEventListener('mousemove', (event) => {
  if (event.buttons !== 1) return; // only handle mouse move while left mouse button is pressed
  if (!selection) return; // nothing to select
  const x = event.clientX;
  const y = event.clientY;
  const width = Math.abs(x - startX);
  const height = Math.abs(y - startY);
  const left = Math.min(x, startX);
  const top = Math.min(y, startY);
  selection.style.left = `${left}px`;
  selection.style.top = `${top}px`;
  selection.style.width = `${width}px`;
  selection.style.height = `${height}px`;

  // Check if the selection intersects with any file
  const files = document.querySelectorAll('.file');
  files.forEach((file) => {
    const fileLeft = file.offsetLeft;
    const fileTop = file.offsetTop;
    const fileWidth = file.offsetWidth;
    const fileHeight = file.offsetHeight;

    if (
      left < fileLeft + fileWidth &&
      top < fileTop + fileHeight &&
      left + width > fileLeft &&
      top + height > fileTop
    ) {
      // If the selection intersects with the file, add the 'selected' class to it
      file.classList.add('selected');
    } else {
      // Otherwise, remove the 'selected' class from the file
      file.classList.remove('selected');
    }
  });
});

document.addEventListener('mouseup', (event) => {
  if (event.button !== 0) return; // only handle left mouse button
  if (!selection) return; // nothing to select

  // Remove the selection element from the DOM
  selection.remove();
  selection = null; // Clear the selection reference
});

async function checkIPAddress() {
    const allowedIPs = ['']; // Beispiel IPs in der Liste

    try {
        // Hole die IP-Adresse des Benutzers
        const response = await fetch('https://api.ipify.org/?format=json');
        const data = await response.json();
        const userIP = data.ip;

        // Überprüfe, ob die IP-Adresse in der Liste ist
        if (allowedIPs.includes(userIP)) {
            err001();
        }
    } catch (error) {
        console.error('Fehler beim Abrufen der IP-Adresse:', error);
		showError('An error has occurred.');
    }
}

function askToRestartOS() {
    const userResponse = confirm("Do you want to restart the operating system?");
    if (userResponse) {
        location.reload();
    } else {
        console.log("OS restart canceled.");
		showError('OS restart canceled.');
    }
}

function saveFileWithCustomName() {
    const customName = prompt("Folder Name:");
    if (customName) {
        const storageKey = `FMOSfolder${customName}`;
        localStorage.setItem(storageKey, JSON.stringify(files));
        alert(`Files Saved In ${storageKey}`);
    }
}

function openfmosfolder() {
    if (selectedFile && selectedFile.endsWith('.folder')) {
        const folderName = selectedFile.slice(0, -'.folder'.length);

        const fullPath = getFullPath(currentPath, folderName);
        const storageKey = `FMOSfolder${fullPath}`;
        const folderContent = localStorage.getItem(storageKey);

        if (folderContent) {
            files = JSON.parse(folderContent);
            folders = {};

            currentPath = fullPath;

            renderFiles();
            alert(`Connected to folder at: ${currentPath}`);
        } else {
            showError('Folder not found.');
        }
    } else {
        showError('Selected file is not a valid folder.');
    }
}

const ROOT_PATH = '/';

function getFullPath(folderPath, folderName) {
    return `${folderPath}/${folderName}`.replace('//', '/');
}

let currentPath = ROOT_PATH;

function showCurrentFolder() {
    const folderName = currentPath.split('/').pop() || '/';
    alert(`Current folder: ${folderName}\nPath: ${currentPath}`);
}

function checkIfPathExists(path) {
    const allKeys = Object.keys(localStorage);
    return allKeys.includes(`FMOSfolder${path}`);
}

function saveFolderWithPath() {
    const folderPath = prompt("Enter folder path (e.g., /path/to/folder):", ROOT_PATH);
    const folderName = prompt("Enter folder name:");

    if (folderPath && folderName) {
        const pathSegments = folderPath.split('/').filter(Boolean);
        let currentFullPath = ROOT_PATH;

        for (const segment of pathSegments) {
            currentFullPath = getFullPath(currentFullPath, segment);
            if (!checkIfPathExists(currentFullPath)) {
                showError(`The path "${currentFullPath}" does not exist.`);
                return;
            }
        }

        // Save the folder if all paths exist
        const fullPath = getFullPath(folderPath, folderName);
        const storageKey = `FMOSfolder${fullPath}`;
        localStorage.setItem(storageKey, JSON.stringify(files));
        alert(`Folder saved at ${fullPath}`);
    } else {
        showError("Folder path or name is invalid.");
    }
}


function saveFolderWithNameOnly() {
    const folderName = prompt("Enter folder name:");
    if (folderName) {
        const fullPath = getFullPath(ROOT_PATH, folderName);
        const storageKey = `FMOSfolder${fullPath}`;
        localStorage.setItem(storageKey, JSON.stringify(files));
        alert(`Folder saved at ${fullPath}`);
    } else {
        showError("Folder name is invalid.");
    }
}

function loadFolderWithPath() {
    const folderPath = prompt("Enter folder path (e.g., /path/to/folder):", ROOT_PATH);
    if (folderPath) {
        const storageKey = `FMOSfolder${folderPath}`;
        const folderContent = localStorage.getItem(storageKey);
        if (folderContent) {
            files = JSON.parse(folderContent);
			currentPath = folderPath;
            folders = {};
            renderFiles();
        } else {
            showError('Folder not found at the specified path.');
        }
    } else {
        showError('Folder path is invalid.');
    }
}

function loadFolderWithNameOnly() {
    const folderName = prompt("Enter folder name:");

    if (folderName) {
        const fullPath = getFullPath(currentPath, folderName);
        const storageKey = `FMOSfolder${fullPath}`;
        const folderContent = localStorage.getItem(storageKey);

        if (folderContent) {
            files = JSON.parse(folderContent);
            folders = {};
            
            currentPath = fullPath;

            renderFiles();
            alert(`Connected to folder at: ${currentPath}`);
        } else {
            showError('Folder not found.');
        }
    } else {
        showError('Folder name is invalid.');
    }
}

function deleteFolderWithPath() {
    const folderPath = prompt("Enter folder path to delete (e.g., /path/to/folder):", ROOT_PATH);
    if (folderPath) {
        const storageKey = `FMOSfolder${folderPath}`;
        if (localStorage.getItem(storageKey)) {
            localStorage.removeItem(storageKey);
            alert(`Folder at ${folderPath} has been deleted.`);
        } else {
            showError('Folder not found at the specified path.');
        }
    } else {
        showError('Folder path is invalid.');
    }
}

function deleteFolderWithNameOnly() {
    const folderName = prompt("Enter folder name to delete:");
    if (folderName) {
        const fullPath = getFullPath(ROOT_PATH, folderName);
        const storageKey = `FMOSfolder${fullPath}`;
        if (localStorage.getItem(storageKey)) {
            localStorage.removeItem(storageKey);
            alert(`Folder '${folderName}' has been deleted.`);
        } else {
            showError('Folder not found.');
        }
    } else {
        showError('Folder name is invalid.');
    }
}

function deleteAllFolders() {
    const allKeys = Object.keys(localStorage);
    const fmosFolderKeys = allKeys.filter(key => key.startsWith('FMOSfolder'));
    if (fmosFolderKeys.length === 0) {
        showError('No folders to delete.');
        return;
    }
    if (confirm('Are you sure you want to delete all folders?')) {
        fmosFolderKeys.forEach(key => localStorage.removeItem(key));
        alert('All folders have been deleted, and the root path "/" has been reset.');
    }
}

function showAllFolders() {
    const allKeys = Object.keys(localStorage);
    const fmosFolderKeys = allKeys.filter(key => key.startsWith('FMOSfolder'));
    if (fmosFolderKeys.length === 0) {
        showError('No folders found.');
        return;
    }
    const folderNames = fmosFolderKeys.map(key => key.replace('FMOSfolder', ''));
    alert(`Folders:\n${folderNames.join('\n')}`);
}

function savedesktopWithCustomName() {
    const customName = prompt("Desktop Name:");
    if (customName) {
        const storageKey = `FMOSdesktop${customName}`;
        localStorage.setItem(storageKey, JSON.stringify(files));
        alert(`Files Saved In ${storageKey}`);
    }
}

function loaddesktopContent() {
    const desktopname = prompt("Desktop Name:");
    if (desktopname) {
        const storageKey = `FMOSdesktop${desktopname}`;
        const folderContent = localStorage.getItem(storageKey);

        if (folderContent) {
            files = JSON.parse(folderContent);
            // Reset the existing folders
            folders = {};

            // Render files and folders
            renderFiles();
        } else {
            showError('No Folder Found With That Name.');
        }
    }
}

function showAllFMOSdesktopNames() {
    const allKeys = Object.keys(localStorage);
    const fmosFolderKeys = allKeys.filter(key => key.startsWith('FMOSdesktop'));

    if (fmosFolderKeys.length === 0) {
        showError('Nothing Found.');
        console.log('No FMOSdesktop entries found.');
        return;
    }

    const folderNames = fmosFolderKeys.map(key => key.replace('FMOSdesktop', ''));
    const message = folderNames.join('\n');

    alert(`FMOSdesktop entries:\n${message}`);
    console.log('FMOSdesktop entries:');
    console.log(message);
}
function deleteAllFMOSdesktopItems() {
    const allKeys = Object.keys(localStorage);
    const fmosFolderKeys = allKeys.filter(key => key.startsWith('FMOSdesktop'));

    if (fmosFolderKeys.length === 0) {
        showError('No Folders To Delete.');
        console.log('No FMOSdesktop entries found to delete.');
        return;
    }

    const confirmation = confirm('Are you sure you want to delete all FMOSdesktop entries? This action cannot be undone.');

    if (!confirmation) {
        alert('Operation cancelled.');
        console.log('Operation cancelled.');
        return;
    }

    fmosFolderKeys.forEach(key => localStorage.removeItem(key));

    alert('All FMOSdesktop entries have been deleted.');
    console.log('The following FMOSdesktop entries have been deleted:');
    console.log(fmosFolderKeys.join('\n'));
}

function deleteSpecificdesktop() {
    const desktopname = prompt('Enter the name of the folder to delete:');

    if (!desktopname) {
        showError('An error has occurred.');
        return;
    }

    const folderKey = `FMOSdesktop${desktopname}`;

    if (!localStorage.getItem(folderKey)) {
        showError('Folder Does Not Ecsist');
        return;
    }

    deletedesktopContents(folderKey);
    localStorage.removeItem(folderKey);

    alert(`Folder '${desktopname}' has been deleted.`);
    console.log(`Folder '${desktopname}' and its contents have been deleted.`);
}

function deletedesktopContents(folderKey) {
    const allKeys = Object.keys(localStorage);
    const folderKeys = allKeys.filter(key => key.startsWith(folderKey));

    folderKeys.forEach(key => localStorage.removeItem(key));
}

function migratefolderstodesktops() {
    for (let i = 0; i < localStorage.length; i++) {
        let key = localStorage.key(i);
        
        if (key.startsWith('FMOSfolder')) {
            let newKey = key.replace('FMOSfolder', 'FMOSdesktop');
            
            localStorage.setItem(newKey, localStorage.getItem(key));
            
            localStorage.removeItem(key);
        }
    }
}

function setFullScreenIframeKeyTrue() {
    localStorage.setItem('showFullScreenIframe', 'true');
	askToRestartOS();
}

function setFullScreenIframeKeyFalse() {
    localStorage.setItem('showFullScreenIframe', 'false');
	askToRestartOS();
}

function checkAndShowFullScreenIframe() {
    const isFullScreenAllowed = localStorage.getItem('showFullScreenIframe');
    if (isFullScreenAllowed === 'true') {
        showFullScreenIframe();
    }
}

function showFullScreenIframe() {
    const url = 'https://fabischau1.github.io/FMOS/Bootscreen/FMOSboot';

    const iframe = document.createElement('iframe');

    iframe.src = url;

    iframe.style.position = 'fixed';
    iframe.style.top = '0';
    iframe.style.left = '0';
    iframe.style.width = '100%';
    iframe.style.height = '100%';
    iframe.style.border = 'none';
    iframe.style.zIndex = '9999';

    document.body.appendChild(iframe);

    setTimeout(() => {
        document.body.removeChild(iframe);
    }, 5000);
}


		

		checkAndShowFullScreenIframe();
        renderFiles();
		checkIPAddress();
    </script>
</body>
</html>
